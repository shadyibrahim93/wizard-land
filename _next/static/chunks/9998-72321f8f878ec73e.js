"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9998],{9998:(e,t,r)=>{r.r(t),r.d(t,{default:()=>w});var l=r(5155),i=r(2115),n=r(973),a=r(9252),o=r(5744),u=r(5361),s=r(104),c=r(6646),p=r(5385),m=r(7055),f=r(9206),d=r(6710),h=r(8410),y=r(5695),v=r(6562);let g=()=>{let e=[];for(let t=0;t<8;t++){let r=[];for(let e=0;e<8;e++)(t+e)%2==1?t<3?r.push({piece:"Ice",king:!1,validMove:!1}):t>4?r.push({piece:"Fire",king:!1,validMove:!1}):r.push({piece:null,king:!1,validMove:!1}):r.push({piece:null,king:!1,validMove:!1});e.push(r)}return e},w=()=>{let[e,t]=(0,i.useState)(g()),[r,w]=(0,i.useState)(!1),[S,k]=(0,i.useState)(null),[F,M]=(0,i.useState)(!1),[I,E]=(0,i.useState)(0),[x,q]=(0,i.useState)(0),[j,b]=(0,i.useState)(!1),[$,N]=(0,i.useState)("Fire"),[T,L]=(0,i.useState)(null),[C,_]=(0,i.useState)("Single"),[D,A]=(0,i.useState)(null),[G,O]=(0,i.useState)(null),[W,Y]=(0,i.useState)(null),[R,B]=(0,i.useState)(3),[H,J]=(0,i.useState)(null),[K,P]=(0,i.useState)(null),[Q,X]=(0,i.useState)(null),[z,U]=(0,i.useState)(!1),[V,Z]=(0,i.useState)(0),[ee,et]=(0,i.useState)([]),{userId:er,userName:el}=(0,m.J)(),ei=(0,p.v)(H||er,"\uD83D\uDD25","fire"),en=(0,p.v)(K,"❄️","ice"),[ea,eo]=(0,i.useState)(""),[eu,es]=(0,i.useState)(!1),[ec,ep]=(0,i.useState)(!1),[em,ef]=(0,i.useState)(null),[ed,eh]=(0,i.useState)(null),ey=(0,y.useRouter)(),[ev,eg]=(0,i.useState)(!1),[ew,eS]=(0,i.useState)(0),[ek,eF]=(0,i.useState)(""),[eM,eI]=(0,i.useState)(""),eE=`Welcome to Wizard Land Checkers Game! Play as '🔥'. Take turns moving your pieces into the corresponding box. A helper will show you where the piece can be dropped. Be the first to capture all pieces or block the opponent from making any more and win the game. Good luck!`,ex=(e,t)=>e>=0&&e<8&&t>=0&&t<8,eq=e=>e.map(e=>e.map(e=>({...e,validMove:!1})));(0,i.useEffect)(()=>{(async()=>{(ej(e)||S)&&(w(!0),"Multiplayer"===C&&(S===er?(es(!0),await (0,s.Hy)(S,R)):S!==er&&await (0,s.oH)(er,R)),S===er||"Fire"===S?((0,a.Yj)(),(0,u.Lk)()):S!==er&&(0,a.SI)(),"Multiplayer"===C?H===S?E(I+1):K===S&&Z(V+1):("Fire"===S&&E(I+1),"Ice"===S&&q(x+1)),(0,a.XQ)(),b(!0),(0,a.XQ)(),b(!0),setTimeout(()=>{"Multiplayer"===C?ep(!0):eG(),b(!1),eo("")},3500))})()},[S]),(0,i.useEffect)(()=>{if(!Q?.room)return;let e=(0,s.PI)(Q.room,e=>{let{user_id:t,choice:r}=e;t===er?null==em&&ef(r):null==ed&&eh(r)});return()=>s.ND.realtime.removeChannel(e)},[Q,er,ew]),(0,i.useEffect)(()=>{if(null==em||null==ed)return;let e="up"===em&&"up"===ed,t=Q.room;(0,s.DL)(t).then(()=>{ef(null),eh(null),ep(!1),eS(e=>e+1),e?eG():eO()}).catch(console.error)},[em,ed]);let ej=e=>{let t=e.flat().filter(e=>"Fire"===e.piece).length,r=e.flat().filter(e=>"Ice"===e.piece).length,l=eb("Fire"),i=eb("Ice");return 0!==t&&l?(0===r||!i)&&(k("Multiplayer"===C?H:"Fire"),!0):(k("Multiplayer"===C?K:"Ice"),!0)},eb=t=>{for(let r=0;r<8;r++)for(let l=0;l<8;l++){let i=e[r][l];if(i.piece===t)for(let[n,a]of i.king?[[-1,-1],[-1,1],[1,-1],[1,1]]:"Fire"===t?[[-1,-1],[-1,1]]:[[1,-1],[1,1]]){let i=r+n,o=l+a,u=r+2*n,s=l+2*a,c="Fire"===t?"Ice":"Fire";if(ex(i,o)){if(!e[i][o].piece)return!0;else if(ex(u,s)&&e[i][o].piece===c&&!e[u][s].piece)return!0}}}return!1},e$=(e,t,r)=>{let{piece:l,king:i}=r[e][t],n="Fire"===l?"Ice":"Fire";return(i?[[-1,-1],[-1,1],[1,-1],[1,1]]:"Fire"===l?[[-1,-1],[-1,1]]:[[1,-1],[1,1]]).some(l=>{let[i,a]=l,o=e+2*i,u=t+2*a;return ex(o,u)&&r[e+i]?.[t+a]?.piece===n&&!r[o][u].piece})},eN=async(r,l,i,n)=>{let o=e.map(e=>e.map(e=>({...e}))),u=o[r][l].piece,c=o[r][l].king;if(o[i][n].piece=u,o[i][n].king=c||!c&&("Fire"===u&&0===i||"Ice"===u&&7===i),o[r][l].piece=null,o[r][l].king=!1,2===Math.abs(r-i)){let e=(l+n)/2;if(o[(r+i)/2][e].piece=null,(0,a.Gj)(),e$(i,n,o)){t(eq(o)),"Single"===C&&"Ice"===u?Y({row:i,col:n}):(A({row:i,col:n}),O({row:i,col:n})),eL(i,n,o);return}}if(t(eq(o)),A(null),O(null),Y(null),"Multiplayer"===C){let e=T===H?K:H;L(e);let t=ej(o)?"Fire"===o[i][n].piece?H:K:null;(0,s.lu)(Q.room,o,R,e,t)}else N("Fire"===u?"Ice":"Fire"),ej(o)},eT=(0,i.useRef)(!0);(0,i.useEffect)(()=>{if(eT.current){eT.current=!1;return}if(S)return;let e="";"Multiplayer"===C&&H?e=T===K?ei.key:en.key:"Single"===C&&"Ice"===$&&(e=ei.key),(0,a.oS)(e)},[T,$]);let eL=function(r,l){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=i.map(e=>e.map(e=>({...e,validMove:!1}))),{piece:a,king:o}=i[r][l],u="Fire"===a?"Ice":"Fire",s=o?[[-1,-1],[-1,1],[1,-1],[1,1]]:"Fire"===a?[[-1,-1],[-1,1]]:[[1,-1],[1,1]],c=!1;s.forEach(e=>{let[t,a]=e,o=r+2*t,s=l+2*a;ex(o,s)&&i[r+t]?.[l+a]?.piece===u&&!i[o][s].piece&&(n[o][s].validMove=!0,c=!0)}),c||s.forEach(e=>{let[t,a]=e,o=r+t,u=l+a;ex(o,u)&&!i[o][u].piece&&(n[o][u].validMove=!0)}),t(n)},eC=()=>{setTimeout(()=>{if(W){let{row:t,col:r}=W,l=[];for(let[i,n]of e[t][r].king?[[-1,-1],[-1,1],[1,-1],[1,1]]:[[1,-1],[1,1]]){let a=t+i,o=r+n,u=t+2*i,s=r+2*n;ex(u,s)&&e[a]?.[o]?.piece==="Fire"&&!e[u][s].piece&&l.push({from:{r:t,c:r},to:{r:u,c:s}})}if(l.length>0){let e=l[Math.floor(Math.random()*l.length)];eN(e.from.r,e.from.c,e.to.r,e.to.c);return}Y(null),N("Fire");return}let t=[],r=[];for(let l=0;l<8;l++)for(let i=0;i<8;i++){let n=e[l][i];if("Ice"===n.piece)for(let[a,o]of n.king?[[-1,-1],[-1,1],[1,-1],[1,1]]:[[1,-1],[1,1]]){let n=l+a,u=i+o,s=l+2*a,c=i+2*o;ex(s,c)&&e[n]?.[u]?.piece==="Fire"&&!e[s][c].piece?t.push({from:{r:l,c:i},to:{r:s,c:c}}):ex(n,u)&&!e[n][u].piece&&r.push({from:{r:l,c:i},to:{r:n,c:u}})}}if(t.length>0){let e=t[Math.floor(Math.random()*t.length)];eN(e.from.r,e.from.c,e.to.r,e.to.c);return}if(r.length>0){let e=r[Math.floor(Math.random()*r.length)];eN(e.from.r,e.from.c,e.to.r,e.to.c)}else N("Fire")},1e3)},e_=t=>{for(let r=0;r<8;r++)for(let l=0;l<8;l++){let i=e[r][l];if(i.piece===t)for(let[n,a]of i.king?[[-1,-1],[-1,1],[1,-1],[1,1]]:"Fire"===t?[[-1,-1],[-1,1]]:[[1,-1],[1,1]]){let i=r+n,o=l+a,u=r+2*n,s=l+2*a,c="Fire"===t?"Ice":"Fire";if(ex(u,s)&&e[i]?.[o]?.piece===c&&!e[u][s].piece)return!0}}return!1},eD=(t,l)=>{let i=e[t][l];if(!r){if("Multiplayer"===C){if(!z)return;if(T!==er)return void alert("Not your turn!")}else if("Fire"===$&&"Fire"!==i.piece&&!D||"Ice"===$&&"Ice"!==i.piece&&!D)return;if(D&&i.validMove)return void eN(D.row,D.col,t,l);if("Multiplayer"===C&&i.piece===(er===H?"Fire":"Ice")||"Single"===C&&i.piece===$){if(e_("Multiplayer"===C?er===H?"Fire":"Ice":$)&&!e$(t,l,e))return void alert("You must make a capture move if available!");A({row:t,col:l}),eL(t,l)}}};(0,i.useEffect)(()=>{"Single"===C&&"Ice"===$&&W&&!r&&eC()},[W,$,r,C]),(0,i.useEffect)(()=>{"Single"!==C||"Ice"!==$||r||eC()},[$,r,C]);let eA=async r=>{r&&r.room?(X(r),J(r.player1),P(r.player2),eF(r.player1name||""),eI(r.player2name||""),_("Multiplayer"),M(!0),L(r.player1),U(!!r.player1&&!!r.player2),et([(0,s.Z5)(r.room,t=>{J(t.player1),P(t.player2),eF(t.player1name||""),eI(t.player2name||""),U(!!t.player1&&!!t.player2),(0,a.NL)("battle"),t.player1&&t.player2&&e.every(e=>e.every(e=>null===e.piece))&&(0,s.lu)(r.room,g(),R,t.player1)}),(0,s.qk)(r.room,e=>{e.board_state&&(t(e.board_state),w(!1),k(null),b(!1),ep(!1),eo(""),ef(null),eh(null),(0,s.DL)(e.room)),void 0!==e.current_turn&&null!==e.current_turn&&L(e.current_turn),e.winner&&(eo(e.name),k(e.winner),(0,f.v)(e.winner,"easy"),(0,s.JI)(e.room,e.game_id))})])):(_("Single"),M(!0))},eG=()=>{let e=g();if(t(e),w(!1),k(null),b(!1),A(null),O(null),Y(null),"Single"===C)N("Fire");else if("Multiplayer"===C){let t=S===K?K:H;L(t),(0,s.lu)(Q.room,e,R,t)}(0,a.SW)()},eO=()=>{eg(!1),"Multiplayer"===C&&((0,s.i4)(Q.room,R),(0,s.Kt)(Q.room)),ey.push("/")};(0,i.useEffect)(()=>()=>{"Multiplayer"===C&&(0,s.Kt)(ee)},[ee]),(0,i.useEffect)(()=>{let e;if("Multiplayer"!==C)return;let t=()=>{clearTimeout(e),e=window.setTimeout(()=>{eg(!0)},3e4)},r=["mousemove","keydown","mousedown","touchstart"];return r.forEach(e=>window.addEventListener(e,t)),t(),()=>{clearTimeout(e),r.forEach(e=>window.removeEventListener(e,t))}},[K]),(0,i.useEffect)(()=>{if("Multiplayer"!==C)return;window.history.pushState(null,"",window.location.href);let e=e=>{e.preventDefault(),window.history.pushState(null,"",window.location.href),eg(!0)};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)},[C]),(0,i.useEffect)(()=>{if("Multiplayer"!==C)return;let e=e=>{eg(!0),e.preventDefault(),e.returnValue=""};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[C]),(0,i.useEffect)(()=>{if(!Q?.room||"Multiplayer"!==C)return;let e=Date.now(),t=setInterval(()=>{Date.now()-e>6e4&&(alert("Ops, Opponent left the game! What a bummer!"),eO())},1e4);return()=>clearInterval(t)},[e]);let eW=null===S&&ej(e)?"It's a Draw!":S?"Multiplayer"===C?`${ea} wins!`:`${S} wins!`:"Multiplayer"===C?T===er?"Your Turn":"Opponent Turn":"Fire"===$?"Your Turn":"Computer Turn";return F?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mq-global-container",children:[(0,l.jsxs)("div",{className:"mq-score-container",children:[(0,l.jsx)("span",{className:"mq-score-player",children:(0,l.jsxs)("span",{className:"mq-score-player",children:[ek||el,": ",I]})}),(0,l.jsxs)("span",{className:"mq-room-number",children:[Q&&Q.room," ",Q&&Q.password&&`- ${Q.password}`]}),(0,l.jsx)("span",{className:"mq-score-computer",children:"Multiplayer"===C?eM?`${eM}: ${V}`:"Waiting opponent...":`Ice: ${x}`})]}),(0,l.jsxs)("div",{className:`mq-board mq-${"Multiplayer"===C?T===H?ei.theme:en.theme:"Fire"===$?ei.theme:"ice"}`,children:[j&&(0,l.jsx)("h1",{className:`mq-ending-title ${("Ice"===S||S===K)&&"glowingBlue-text"}`,children:eW}),e.map((e,t)=>(0,l.jsx)("div",{className:"mq-row",children:e.map((e,r)=>(0,l.jsxs)("div",{className:`mq-square ${(t+r)%2==1?"mq-dark":"mq-light"}       
                  ${e.piece?`mq-${!e.king?"Fire"===e.piece?ei.key+" mq-fire":en.key+" mq-ice":"Fire"===e.piece?`${ei.key}-king`:`${en.key}-king`}`:""} 
                  ${e.validMove?"valid":""} 
                  ${D?.row===t&&D?.col===r?"mq-selected":""} 
                  ${"Fire"===e.piece&&!ei.display&&!e.king||"Ice"===e.piece&&!en.display&&!e.king?"mq-image":""}`,onClick:()=>eD(t,r),children:["Fire"===e.piece&&(e.king?"♔":ei.display||ei.image||"\uD83D\uDD25"),"Ice"===e.piece&&(e.king?"♚":en.display||en.image||"❄️")]},`${t}-${r}`))},t))]})]}),(0,l.jsx)(o.A,{text:"Reset Score",onClick:()=>{q(0),E(0)}}),eu&&(0,l.jsx)(d.T,{onComplete:()=>es(!1)}),(0,l.jsx)(h.A,{isOpen:ec,onClose:()=>{ep(!1)},onThumbsUp:()=>{ef("up"),(0,s.r7)(Q.room,er,"up")},onThumbsDown:()=>{ef("down"),(0,s.r7)(Q.room,er,"down")}}),(0,l.jsx)(v.A,{isOpen:ev,onConfirm:eO,onCancel:()=>eg(!1),title:"Leave Game? Auto-quit in "})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.A,{introText:eE}),(0,l.jsx)(c.A,{gameId:R,setGameMode:_,onStartGame:e=>eA(e)})]})}}}]);